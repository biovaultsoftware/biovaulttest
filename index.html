<!DOCTYPE html> 
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bio-Vault</title>
  <link rel="manifest" href="./manifest.json">
  <link rel="apple-touch-icon" href="icon.png">
  <meta name="theme-color" content="#000000">
  <meta name="description" content="P2P Bio-Vault for True Value of Money">
  <style>
    /* Basic styling for responsiveness and accessibility */
    body { font-family: Arial, sans-serif; background: #f4f4f4; color: #333; }
    .hidden { display: none; }
    input, button { margin: 5px; padding: 10px; font-size: 16px; }
    .modal { position: fixed; top: 20%; left: 20%; width: 60%; background: white; padding: 20px; border: 1px solid black; z-index: 100; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ddd; padding: 8px; }
    .loading { display: none; } /* For progress indicators */
    @media (max-width: 600px) { .modal { left: 5%; width: 90%; } }
    /* High contrast mode */
    @media (prefers-contrast: high) { body { background: #fff; color: #000; } }
    /* Reduced motion */
    @media (prefers-reduced-motion: reduce) { * { transition: none !important; } }
  </style>
</head>
<body>
  <h1>Bio-Vault</h1>
  <p>WELCOME TO YOUR VAULT WHERE THE TRUE VALUE OF MONEY IS.</p>

  <div id="lockedScreen">
    <button id="enterVaultBtn">Enter Vault</button>
    <div id="passphraseModal" class="hidden">
      <label for="passphrase">Enter Passphrase:</label>
      <input type="password" id="passphrase">
      <button id="savePassphraseBtn">Save</button>
      <button id="cancelPassphraseBtn">Cancel</button>
    </div>
  </div>

  <div id="vaultUI" class="hidden">
    <p>Your Bio-IBAN: <span id="bioIban"></span> <button id="copyIbanBtn">Copy</button></p>
    <p>Balance: <span id="balanceTVM"></span> TVM (<span id="sheMetrics"></span> SHE)</p>
    <p>Equivalent to <span id="balanceUSD"></span> USD</p>
    <p>BonusConstant: <span id="bonusConstant"></span></p>
    <p>UTC Time: <span id="utcTime"></span></p>
    <p>On-Chain Wallet Address: <span id="walletAddress"></span></p>
    <button id="saveWalletBtn">Save Wallet</button>
    <button id="connectMetaMaskBtn">Connect MetaMask</button>
    <button id="connectWalletConnectBtn">Connect WalletConnect</button>

    <div>
      <button id="catchInBtn">Catch In</button>
      <button id="catchOutBtn">Catch Out</button>
    </div>

    <div id="transactionHistory">
      <h2>Transaction History</h2>
      <table id="txTable">
        <thead>
          <tr>
            <th>Bio-IBAN</th>
            <th>Bio-Catch</th>
            <th>Amount (TVM)</th>
            <th>Date/Time</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <button id="exportTxBtn">Export Transactions</button>
      <button id="backupVaultBtn">Backup Vault</button>
      <button id="exportFriendlyBackupBtn">Export Friendly Backup</button>
      <input type="file" id="importVaultInput">
      <button id="importVaultBtn">Import .vault</button>
    </div>

    <p>(Exchange Rate: 1 USD = 12 TVM)</p>

    <button id="lockVaultBtn">Lock Vault</button>
    <button id="terminateVaultBtn">Terminate Vault</button>
  </div>

  <div id="bioCatchModal" class="hidden modal">
    <h2>Your Bio-Catch Number</h2>
    <p id="bioCatchText"></p>
    <button id="copyBioCatchBtn">Copy Bio-Catch</button>
    <button id="closeBioCatchBtn">Close</button>
    <div id="qrCode"></div>
    <button id="shareNfcBtn">Share via NFC</button>
  </div>

  <div id="tvmInteraction">
    <h2>TVM Token Interaction</h2>
    <p>Connected Account: <span id="connectedAccount"></span></p>
    <p>TVM Balance: <span id="tvmBalance"></span></p>
    <p>USDT Balance: <span id="usdtBalance"></span></p>
    <p>Current TVM Price (in USDT base units): <span id="tvmPrice"></span></p>

    <h3>Claim TVM</h3>
    <input id="claim-proofs" placeholder="Proofs (JSON array)">
    <input id="claim-device-key-hash" placeholder="Device Key Hash (bytes32 hex)">
    <input id="claim-user-bio-constant" placeholder="User Bio Constant (uint256)">
    <input id="claim-nonce" placeholder="Nonce (uint256)">
    <button id="generate-claim-signature-btn">Generate Signature</button>
    <input id="claim-signature" placeholder="Signature (hex)" readonly>
    <button id="claim-tvm-btn">Claim TVM</button>
    <div id="claim-loading" class="loading">Processing...</div>

    <h3>Exchange TVM for Segments</h3>
    <input id="exchange-amount" placeholder="Amount (whole TVM)">
    <input id="exchange-device-key-hash" placeholder="Device Key Hash (bytes32 hex)">
    <input id="exchange-proofs" placeholder="Proofs (JSON array)">
    <input id="exchange-user-bio-constant" placeholder="User Bio Constant (uint256)">
    <input id="exchange-nonce" placeholder="Nonce (uint256)">
    <button id="generate-exchange-signature-btn">Generate Signature</button>
    <input id="exchange-signature" placeholder="Signature (hex)" readonly>
    <button id="exchange-tvm-btn">Exchange TVM</button>
    <div id="exchange-loading" class="loading">Processing...</div>

    <h3>Swap TVM for USDT</h3>
    <input id="swap-tvm-amount" placeholder="Amount (whole TVM)">
    <input id="swap-tvm-layer" placeholder="Layer (1-4)">
    <button id="swap-tvm-usdt-btn">Swap TVM for USDT</button>

    <h3>Swap USDT for TVM</h3>
    <input id="swap-usdt-amount" placeholder="Amount (whole TVM to receive)">
    <input id="swap-usdt-layer" placeholder="Layer (1-4)">
    <button id="swap-usdt-tvm-btn">Swap USDT for TVM</button>

    <h3>Transfer TVM</h3>
    <input id="transfer-to" placeholder="To Address">
    <input id="transfer-amount" placeholder="Amount (whole TVM)">
    <button id="transfer-btn">Transfer</button>
  </div>

  <footer>
    <p>By RR.R â€” for Humanity</p>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/ethers@6.13.2/dist/ethers.min.js"></script>
  <script src="https://unpkg.com/@walletconnect/ethereum-provider@2.15.2/dist/umd/index.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.4/build/qrcode.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.1.6/purify.min.js"></script>
  <script src="main.js"></script>
</body>
</html>
